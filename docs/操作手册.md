# A股自选股智能分析系统 - 操作手册

## 🚀 核心指令速查

请在项目根目录下（`e:\project\daily_stock_analysis`），**使用 PowerShell** 运行以下指令。

### 1. 启动 Web 可视化界面 (推荐)
这是最常用的方式，启动后可以在浏览器中管理股票和查看报告。
```powershell
.\.venv\Scripts\python main.py --webui-only
```
- **访问地址**: [http://127.0.0.1:8000](http://127.0.0.1:8000)

### 2. 执行一次完整分析
这会立即分析您配置的所有股票，并发送通知。
```powershell
.\.venv\Scripts\python main.py
```

---

## 🔧 常见问题与故障排查

### 🔴 问题一：Web 界面无法显示 (只显示 JSON)
**现象**：访问 `http://127.0.0.1:8000` 时，只看到 `{"message": "API ..."}`，没有图形界面。
**原因**：后台服务进程卡死，或者端口被旧进程占用。

**✅ 解决方案 (三步走)**：

**第一步：强制关闭所有 Python 进程**
复制以下命令并在终端运行，这将清理所有卡住的后台任务：
```powershell
taskkill /F /IM python.exe
```
*(注：如果提示“没有找到进程”，说明已经清理干净了，是好消息)*

**第二步：重新启动服务**
```powershell
.\.venv\Scripts\python main.py --webui-only
```

**第三步：刷新浏览器**
按 `Ctrl + F5` 强制刷新页面。

---

### 🔴 问题二：提示 `ModuleNotFoundError`
**现象**：运行命令时提示找不到模块，例如 `No module named 'dotenv'`。
**原因**：直接使用了系统默认的 python，而不是项目的虚拟环境。

**✅ 解决方案**：
请务必使用完整路径 `.\.venv\Scripts\python` 来运行所有命令。
- ❌ 错误：`python main.py`
- ✅ 正确：`.\.venv\Scripts\python main.py`

---

## 🛠️ 新增：专家会诊功能 (v2.0)

多模型决策支持，降低单模型误判风险。

### 1. 专家会诊 (`/expert-panel`)
进入 WebUI 后，点击左侧会诊中心，即可针对特定股票发起多模型分析。系统将展示各模型的**独立评分**、**观点对比**并生成**自动汇总报告**。

### 2. 混合配置层
支持从数据库加载配置，方便在不重启服务的情况下修改 API Key 或股票列表。
- 设置环境变量 `CONFIG_STORAGE_TYPE=db` 开启该模式。

---

## 📁 核心文件说明
- `main.py`: 主程序入口。
- `.env`: 配置文件 (包含 API Key 和股票列表)。
- `logs/`: 存放运行日志，报错时可以看这里。
- `data/`: 存放生成的分析报告和数据库。
